#+TITLE: *Modelling the effects of domestication in Wheat through novel computer vision techniques*
#+OPTIONS: title:nil toc:nil H:4 author:nil date:nil TeX:t LaTeX:t
#+EXPORT_SELECT_TAGS: export
#+EXPORT_EXCLUDE_TAGS: noexport
#+INCLUDE: "./preamble.org"
#+BEGIN_LaTeX
  \thispagestyle{empty}
  \renewcommand{\headrulewidth}{0pt}
  \begin{center}
    \fontsize{10}{12}
    \selectfont

    \textbf{\huge Modelling the effects of domestication in Wheat through novel computer vision techniques}

    \vspace{0.3in}

    \begin{tabular}[t]{ll}
      Author: & Nathan Hughes (nah26@aber.ac.uk) \\
      Supervisor: & Dr. Wayne Aubrey (waa2@aber.ac.uk) \\
      Degree Scheme &  G401 \hspace*{0.05in}(Computer Science)\\
      \\
      \\
      Date: & \today \\
      Revision: & 0.1\\
      Status: & Draft\\
      \\
    \end{tabular}
    \\
    \vspace{0.1in}
    This report was submitted as partial fulfilment \\of a BSc degree in Computer Science (G401)
  \end{center}
  \clearpage
  \renewcommand{\headrulewidth}{1pt}
#+END_LaTeX
#+BEGIN_LaTeX
  \thispagestyle{plain}

  \begin{center}
    {\LARGE\bf Declaration of originality}
  \end{center}

  I confirm that:

  \begin{itemize}
  \item{This submission is my own work, except where
      clearly indicated.}

  \item{I understand that there are severe penalties for Unacceptable Academic Practice, which can lead to loss of marks or even the withholding of a degree.}

  \item{I have read the regulations on Unacceptable Academic Practice from the University's Academic Quality and Records Office (AQRO) and the relevant sections of the current Student Handbook of the Department of Computer Science.}

  \item{In submitting this work I understand and agree to abide by the University's regulations governing these issues.}
  \end{itemize}

  \vspace{2em}
  Name ............................................................  \\

  \vspace{1em}
  Date ............................................................ \\

  \vspace{1em}
  \begin{center}
    {\LARGE\bf Consent to share this work}
  \end{center}

  By including my name below, I hereby agree to this dissertation being made available to other students and academic staff of the Aberystwyth Computer Science Department.

  \vspace{2em}
  Name ............................................................  \\

  \vspace{1em}
  Date ............................................................ \\

  \clearpage
  \tableofcontents
  \listoftables
  \listoffigures
  \listoflistings
  \clearpage
#+END_LaTeX
#+BEGIN_COMMENT
A research project
A research project might use the following top-level structure:
Chapter 1: Background, Analysis and Process
Chapter 2: Method Design
Chapter 3: Software Design, Implementation and Testing
Chapter 4: Results and Conclusion
Chapter 5: Critical Evaluation
#+END_COMMENT
#+BEGIN_COMMENT

Problem Analysis (15%)
This area will assess the project as described in the background, objectives and
overview of the development process or research method(s).

-Preparation: This will assess how well you researched the background to the
project topic, how well you understood what you read and how well you
presented this preparation with appropriate citations and bibliographic entries.
Some of the material you wrote for your Outline Project Specification may be
reused here, but it would need to be more detailed.

- Analysis: This will assess your understanding of the problems for your project,
how well you assessed alternative approaches and your justification for the
approach you selected.


There should be a clear statement of the objectives of the work or the research
question, which you will evaluate at the end of the project.
For plan-driven software development projects, it would be appropriate to
include a full requirements specification as an appendix, and refer to the key
issues in this section. For an agile project, the requirements should be
expressed in a format appropriate to the choice of agile approach, e.g. a set of
top-level user stories.

#+END_COMMENT


* Introduction, Analysis and Objectives

** Background

** Problem Analysis

** Objectives

* Method Design

** Improvements to 3D imaging software
*** New Watershed Algorithm

In order to solve the problem of misidentified and joint seeds, from the primitive collection,
I implemented a /quasi-euclidean/ distance transform into the analysis pipeline cite:Hughes2017. This provided much better results than the previous
/chessboard/ transform which had been successful on more uniform data.

**** Quasi-Euclidean algorithm

This algorithm measures the total euclidean distance along a set of horizontal, vertical and diagonal
line segments cite:Pfaltz1966.

#+NAME: eqn:qe
\begin{equation}
\left | x_1 - x_2 \right | + (\sqrt{2}-1), \left | x_1 - x_2 \right | >\left | y_1 - y_2 \right | (\sqrt{2}-1) \left | x_1 - x_2 \right | ,\textup{otherwise}
\end{equation}


In order to apply this to a 3D space Kleinberg's method is used  cite:Kleinberg1997. This allows for nearest neighbour pixels to be sorted by $k$-dimensional trees
and enabling fast distance transforms via Rosenfeld and Pfaltz's /quasi-euclidean/ method stated in equation:[[eqn:qe]].


** Testing of Software

* Software Design, Testing and Implementation

** Software Development Methodology

** Data Pipeline

#+NAME: fig:matlab
#+BEGIN_SRC  plantuml :results file :file ./images/matlab.png
(*) -> "Scan Wheat Spikes"

partition MATLAB {
--> "Load Raw Scan Data"
-> "Convert to 2D Image Stacks"
--> "Calculate Threshold Percentile"
-left-> "Segment and Mask via Threshold"
--> "Calculate 3D Quasi-Euclidean Distance"
If "Seeds Joined" then
--> [Yes] "Separate by Watershed"
--> "Detect Objects"
else
-> [No] "Detect Objects"
Endif



-> "Record Measurements"
--> [For each seed] "Record Measurements"

--> "Output Data to CSV format"
}
->(*)

#+END_SRC
#+BEGIN_CENTER
#+CAPTION: Image Processing Pipeline
#+ATTR_LATEX: :width 10cm
#+NAME: fig:matlab
[[file:./images/matlab.png]]
#+RESULTS: fig:matlab
#+END_CENTER


#+NAME: fig:pipeline
#+BEGIN_SRC  plantuml :results file :file ./images/pipeline.png

(*) -> "MATLAB Output"
partition Python {
-right-> "Load and Convert data to CTData Objects"

If "Check for \nfalse positives?" then
-> [Yes]"Estimate Error"
--> "Remove Estimated Outliers"
--> "Load in external experiment information"
else
-> [No] "Load in external experiment information"
Endif

If "Spike Joining?" then
-left-> [Yes] "Process logical spike joining"
--> "Aggregate Data columns"
else
--> [No] "Aggregate Data columns"
Endif

If "Normally Distributed?" then
--> [Yes] "Perform Parametric Tests"

--> "Output Results"
else
--> [No] "Perform Non-Parametric Tests"
Endif

--> "Output Results"
}
#+END_SRC
#+BEGIN_CENTER
#+CAPTION: Data Pipeline and Information Flow
#+ATTR_LATEX: :width 10cm
#+NAME: fig:pipeline
[[file:./images/pipeline.png]]
#+RESULTS: fig:pipeline
#+END_CENTER

* Results

** Improved accuracy of imaging software

*** Effect of enhanced watershedding algorithm
#+BEGIN_CENTER
#+CAPTION: /A/ showing the chessboard method, /B/ improved quasi-euclidean method
#+ATTR_LATEX: :width 10cm
#+NAME: fig:qe
[[./images/chess_quasi.png]]
#+END_CENTER

* Discussion
* Critical Evaluation
** Organisational Methods
** Relevance to Degree
** Time Management
** Collaborative Work
** Other Issues


* /Code Segments and Examples/
** MATLAB Watershedding
#+CAPTION: MATLAB Watershedding function
#+LABEL: lst:ws
#+BEGIN_SRC octave
  function [W] = watershedSplit3D(A)
    % Takes image stack A and splits it into stack W
    % Convert to BW
    bw = logical(A);
    % Create variable for opening and closing
    se = strel('disk', 5);
    % Minimise object missshapen-ness
    bw = imerode(bw, se);
    bw = imdilate(bw, se);
    % Fill in any left over holes
    bw = imfill(bw,4,'holes');
    % Use chessboard for distance calculation for more refined splitting
    chessboard = -bwdist(~bw, 'quasi-euclidean');
    % Modify the intensity of our bwdist to produce chessboard2
    mask = imextendedmin(chessboard, 2);
    chessboard2 = imimposemin(chessboard, mask);
    % Calculate watershed based on the modified chessboard
    Ld2 = watershed(chessboard2);
    % Take original image and add on the lines calculated for splitting
    W = A;
    W(Ld2 == 0) = 0;
  end
#+END_SRC



\clearpage
\addcontentsline{toc}{Chapter}{References}
bibliography:~/Dropbox/library.bib
bibliographystyle:IEEEannotU
